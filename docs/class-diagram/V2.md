```mermaid
---
title: Context
theme: 'dark'
config:
  fontFamily: 'Pretendard'
  securityLevel: loose
---
graph LR

%% --- VO or Field ---
    storeId
    companyId
    tagId
    nationalityId
    cuisineId
    restaurantId
    menuId
    userId
    

%% --- Contexts ---
    subgraph User-Context
        general_user[GeneralUser]
        seller_user[SellerUser]
        admin_user[AdminUser]
        resigned_user[ResignedUser]
    end

    subgraph Store-Context
        store[Store]
    end

    subgraph Restaurant-Context
        restaurant[Restaurant]
        restaurant_address[RestaurantAddress]
        restaurant_contact[RestaurantContact]
        restaurant_description[RestaurantDescription]
        restaurant_routine[RestaurantRoutine]
        restaurant_photobook[RestaurantPhotoBook]
        restaurant_tags[RestaurantTags]
        restaurant_nationalities[RestaurantNationalities]
        restaurant_cuisines[RestaurantCuisines]
        restaurant_snapshot[RestaurantSnapshot]
    end

    subgraph Menu-Context
        menu[Menu]
        menu_price[MenuPrice]
        menu_photobook[MenuPhotoBook]
        menu_snapshot[MenuSnapshot]
    end

    subgraph Category-Context
        tag[Tag]
        nationality[Nationality]
        cuisine[Cuisine]
    end

    subgraph Company-Context
        company[Company]
    end

    subgraph Authenticate-Context
        authenticate[Authenticate]
        access_history[AccessHistory]
    end

%% --- Relationships ---
    seller_user -->|has| storeId
    storeId -->|refers| store
    general_user -->|transform| resigned_user
    seller_user -->|transform| resigned_user
    
    store -->|has| companyId
    companyId -->|refers| company

    store -->|has| tagId
    tagId -->|refers| tag
    store -->|has| nationalityId
    nationalityId -->|refers| nationality
    store -->|has| cuisineId
    cuisineId -->|refers| cuisine

    %% Restaurant relationships
    seller_user -->|owns| restaurantId
    restaurantId -->|refers| restaurant
    restaurant -->|has| companyId
    restaurant -->|has| userId
    restaurant -->|contains| restaurant_address
    restaurant -->|contains| restaurant_contact
    restaurant -->|contains| restaurant_description
    restaurant -->|contains| restaurant_routine
    restaurant -->|contains| restaurant_photobook
    restaurant -->|contains| restaurant_tags
    restaurant -->|contains| restaurant_nationalities
    restaurant -->|contains| restaurant_cuisines
    restaurant -->|creates| restaurant_snapshot

    restaurant_tags -->|references| tagId
    restaurant_nationalities -->|references| nationalityId
    restaurant_cuisines -->|references| cuisineId

    %% Menu relationships
    restaurant -->|has| menuId
    menuId -->|refers| menu
    menu -->|contains| menu_price
    menu -->|contains| menu_photobook
    menu -->|creates| menu_snapshot

    %% Authentication relationships
    general_user -->|creates| authenticate
    seller_user -->|creates| authenticate
    admin_user -->|creates| authenticate
    authenticate -->|logs| access_history

```

---

# V3 - Core Module DDD Entity Relationships (Actual Implementation)

```mermaid
---
title: Core Module DDD Entities - Actual Implementation
theme: 'dark'
config:
  fontFamily: 'Pretendard'
  securityLevel: loose
---
classDiagram
    %% User Aggregate
    class User {
        -String? id
        -LoginId loginId
        -Password password
        -PersonalAttributes personalAttributes
        -UserAttribute userAttributes
        +String userLoginId
        +String userEncodedPassword
        +String userEmail
        +String userMobile
        +String userNickname
        +Role userRole
        +resign(EncryptedAttributes) ResignedUser
        +changePassword(Password) void
        +changePersonalAttributes(PersonalAttributes) void
        +changeUserNickname(UserAttribute) void
    }

    class RestaurantOwner {
        -String? id
        -LoginId loginId
        -Password password
        -PersonalAttributes personalAttributes
        -UserAttribute userAttributes
        +String? identifier
        +String userEmail
        +String userMobile
        +String userNickname
        +Role userRole
        +resign(EncryptedAttributes) ResignedUser
        +changePassword(Password) void
    }

    class ResignedUser {
        +String id
        +LoginId loginId
        +EncryptedAttributes encryptedAttributes
        +LocalDateTime resignDateTime
    }

    %% Authentication Aggregate
    class Authenticate {
        +String id
        -LoginId loginId
        -Password password
        -LockState lockState
        +Role role
        -List~AccessHistory~ accessLog
        +boolean passwordCheckSuccess
        +boolean lockCheckSuccess
        +boolean isSuccess
        +int failCount
        +LocalDateTime? lockedDateTime
        +UserStatus userStatus
        +canISignIn(String, SignInPolicy) void
        +String loginId()
    }

    class AccessHistory {
        +String authenticateId
        +String loginId
        +AccessStatus status
        +LocalDateTime accessDateTime
        +success(String, LoginId) AccessHistory
        +failure(String, LoginId) AccessHistory
    }

    %% Company Aggregate
    class Company {
        +String id
        -Brand brand
        -Business business
        -CompanyContact companyContact
        -CompanyAddress companyAddress
        -Representative representative
        +String brandName
        +String brandUrl
        +changeBrand(Brand) void
    }

    %% Restaurant Aggregate
    class Restaurant {
        -String? id
        -String companyId
        -String userId
        -RestaurantDescription introduce
        -RestaurantContact contact
        -RestaurantAddress address
        -RestaurantRoutine routine
        -RestaurantPhotoBook photos
        -RestaurantTags tags
        -RestaurantNationalities nationalities
        -RestaurantCuisines cuisines
        +updateDescription(RestaurantDescription) void
        +updateLocation(RestaurantAddress) void
        +updateContact(RestaurantContact) void
        +snapshot() RestaurantSnapshot
    }

    %% Menu Aggregate
    class Menu {
        -String? id
        -String restaurantId
        -MenuDescription information
        -MenuPhotoBook menuPhotoBook
        -MenuAttributes attributes
        -MenuPrice price
        +snapshot() MenuSnapshot
        +changeInformation(MenuDescription) void
        +changeAttributes(MenuAttributes) void
        +changePrice(MenuPrice) void
    }

    %% Schedule Aggregate
    class Schedule {
        -String restaurantId
        -ScheduleActiveStatus status
        -List~TimeSpan~ timeSpans
        -List~Holiday~ holidays
        -List~Table~ tables
        +addHoliday(Holiday) void
        +addTimeSpan(TimeSpan) void
        +snapshot() ScheduleSnapshot
    }

    class Holiday {
        -String? id
        -String restaurantId
        -LocalDate holidayDate
        +snapshot() HolidaySnapshot
    }

    class TimeSpan {
        -String? id
        -String restaurantId
        -LocalTime startTime
        -LocalTime endTime
        +snapshot() TimeSpanSnapshot
    }

    class Table {
        -String? id
        -String restaurantId
        -int capacity
        -TableStatus status
        +snapshot() TableSnapshot
    }

    %% Category Aggregates
    class Tag {
        +Long id
        -CategoryDetail categoryDetail
        +String title
        +changeTitle(String) void
    }

    class Nationality {
        +Long id
        -CategoryDetail categoryDetail
        +String title
        +changeTitle(String) void
    }

    class Cuisine {
        +Long id
        -CategoryDetail categoryDetail
        +String title
        +changeTitle(String) void
    }

    %% Value Objects (Key ones)
    class LoginId {
        +String loginId
    }

    class Password {
        +String encodedPassword
        +String? oldEncodedPassword
        +LocalDateTime? changedDateTime
    }

    class PersonalAttributes {
        +String email
        +String mobile
    }

    class UserAttribute {
        +String nickname
        +Role role
    }

    class LockState {
        +int failCount
        +LocalDateTime? lockedDateTime
        +UserStatus userStatus
        +isDeactivated() boolean
        +isActivated() boolean
        +addFailureCount() LockState
        +activate() LockState
        +deactivate() LockState
    }

    %% Relationships
    User ||--|| LoginId : contains
    User ||--|| Password : contains
    User ||--|| PersonalAttributes : contains
    User ||--|| UserAttribute : contains
    User --> ResignedUser : creates

    RestaurantOwner ||--|| LoginId : contains
    RestaurantOwner ||--|| Password : contains
    RestaurantOwner ||--|| PersonalAttributes : contains
    RestaurantOwner ||--|| UserAttribute : contains
    RestaurantOwner --> ResignedUser : creates

    Authenticate ||--|| LoginId : contains
    Authenticate ||--|| Password : contains
    Authenticate ||--|| LockState : contains
    Authenticate ||--o{ AccessHistory : logs

    Restaurant ||--|| RestaurantDescription : contains
    Restaurant ||--|| RestaurantContact : contains
    Restaurant ||--|| RestaurantAddress : contains
    Restaurant --> Company : references via companyId
    Restaurant --> RestaurantOwner : references via userId

    Menu --> Restaurant : references via restaurantId
    Menu ||--|| MenuDescription : contains
    Menu ||--|| MenuPrice : contains
    Menu ||--|| MenuAttributes : contains

    Schedule --> Restaurant : references via restaurantId
    Schedule ||--o{ TimeSpan : contains
    Schedule ||--o{ Holiday : contains
    Schedule ||--o{ Table : contains

    Holiday --> Restaurant : references via restaurantId
    TimeSpan --> Restaurant : references via restaurantId
    Table --> Restaurant : references via restaurantId

    Restaurant ||--o{ Tag : associates
    Restaurant ||--o{ Nationality : associates
    Restaurant ||--o{ Cuisine : associates

    %% Inheritance/Implementation
    User ..|> ServiceUser : implements
    RestaurantOwner ..|> ServiceUser : implements
```
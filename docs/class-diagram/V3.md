# Core Module Class Diagram V3

```mermaid
---
title: Core Module - Context Relationships
theme: 'dark'
config:
  fontFamily: 'Pretendard'
  securityLevel: loose
---
graph LR

%% --- ID References ---
    companyId
    userId
    restaurantId
    menuId
    authenticateId
    timeTableId
    tagId
    nationalityId
    cuisineId
    

%% --- Contexts ---
    subgraph User-Context
        user[User]
        restaurant_owner[RestaurantOwner]
        admin[Admin]
        resigned_user[ResignedUser]
    end

    subgraph Authentication-Context
        authenticate[Authenticate]
        access_history[AccessHistory]
    end

    subgraph Company-Context
        company[Company]
    end

    subgraph Restaurant-Context
        restaurant[Restaurant]
        restaurant_tags[RestaurantTags]
        restaurant_nationalities[RestaurantNationalities]
        restaurant_cuisines[RestaurantCuisines]
    end

    subgraph Menu-Context
        menu[Menu]
    end

    subgraph Schedule-Context
        schedule[Schedule]
        time_span[TimeSpan]
        holiday[Holiday]
    end

    subgraph Timetable-Context
        timetable[TimeTable]
        timetable_occupancy[TimetableOccupancy]
    end

    subgraph Category-Context
        tag[Tag]
        nationality[Nationality]
        cuisine[Cuisine]
    end

%% --- User Context Relationships ---
    user -->|has| userId
    restaurant_owner -->|has| userId
    admin -->|has| userId
    
    user -->|transform| resigned_user
    restaurant_owner -->|transform| resigned_user
    admin -->|transform| resigned_user

%% --- Authentication Context Relationships ---
    user -->|creates| authenticate
    restaurant_owner -->|creates| authenticate
    admin -->|creates| authenticate

    authenticate -->|logs| access_history

    access_history -->|references| authenticateId

%% --- Restaurant Context Relationships ---
    restaurant_owner -->|owns| restaurantId
    restaurantId -->|refers| restaurant
    
    restaurant -->|has| companyId
    restaurant -->|has| userId
    restaurant -->|contains| restaurant_tags
    restaurant -->|contains| restaurant_nationalities
    restaurant -->|contains| restaurant_cuisines

    companyId -->|refers| company
    userId -->|refers| user
    userId -->|refers| restaurant_owner

%% --- Menu Context Relationships ---
    restaurant -->|has| menuId
    menuId -->|refers| menu
    
    menu -->|has| restaurantId

%% --- Schedule Context Relationships ---
    restaurant -->|generates| schedule
    schedule -->|has| restaurantId
    schedule -->|contains| time_span
    schedule -->|contains| holiday

    time_span -->|has| restaurantId
    
    holiday -->|has| restaurantId

%% --- Timetable Context Relationships ---
    restaurant -->|generates| timetable
    timetable -->|has| restaurantId
    timetable -->|contains| timetable_occupancy

    timetable_occupancy -->|has| timeTableId
    timetable_occupancy -->|has| userId

    timeTableId -->|refers| timetable

%% --- Category Context Relationships ---
    restaurant_tags -->|references| tagId
    restaurant_nationalities -->|references| nationalityId
    restaurant_cuisines -->|references| cuisineId
    
    tagId -->|refers| tag
    nationalityId -->|refers| nationality
    cuisineId -->|refers| cuisine

```

---

# V3 - Core Module DDD Entity Relationships (Actual Implementation)

This diagram shows the core domain entities from the actual core-module implementation and their **DDD relationships**.

## Key Features

### 1. Hexagonal Architecture
- Each context is clearly separated and operates independently
- Domain references only occur through IDs

### 2. DDD Core Relationship Patterns
- **Ownership**: `restaurant_owner -->|owns| restaurantId`
- **Reference**: `restaurantId -->|refers| restaurant`
- **Generation**: `restaurant -->|generates| schedule`
- **Transformation**: `user -->|transform| resigned_user`
- **Association**: `restaurant -->|associates| tagId`

### 3. Implementation-Based Domains
- **User Context**: Actual implemented User, RestaurantOwner, Admin entities
- **Schedule vs Timetable**: Separated contexts
  - Schedule: Restaurant operation time management
  - Timetable: Actual reservation table management
- **Authentication Context**: Independent authentication system

### 4. Context Responsibilities

#### User Context
- User lifecycle management (creation, transformation, resignation)
- Role-based user classification

#### Restaurant Context  
- Restaurant basic information management
- Starting point for menu, schedule, table generation

#### Menu Context
- Restaurant-specific menu management

#### Schedule Context
- Restaurant operation hours and holiday management

#### Timetable Context
- Actual reservable timeslots and table management
- Table occupancy status management

#### Category Context
- Tag, nationality, cuisine classification management

#### Authentication Context
- User authentication processing

This structure maintains V1's simplicity while reflecting the actual core-module domain complexity.